# تقرير تفصيلي للمترجم العربي الصغير

هذا التقرير يقدّم توثيقًا تفصيليًا للمعمارية وآلية البناء والتشغيل، ومكوّنات النحو العربي، وآلية الفحص الدلالي، والتكامل مع IDE ويندوز، وآلية التغليف.

## 1) المعمارية العامة
- ANTLR Grammar: ملف `grammer/Expr.g4` يعرّف القواعد العربية (برنامج/تعريفات/تعليمات/تعابير/أنواع...).
- التوليد: ملفات ++C في `src/generated/` (Lexer/Parser/Visitor/Listener) ضمن مساحة الأسماء `antlr_generated`.
- التنفيذ:
  - `src/start.h`: يقرأ النص، يُشغّل Lexer/Parser، يجمع التوكنز، يبني شجرة التحليل، ثم يُشغّل الفحص الدلالي إذا لم توجد أخطاء.
  - `src/semantic/TypeCheckerSemanticAnalyzer.h`: زائر دلالي يسجّل الرموز، ويتحقق من التعاريف المكررة ومن الإسناد لمتغيرات غير معرفة، ويقارن الأنواع.
  - `src/CompilerResultsHandler.h`: مُجمِّع نتائج بصيغة JSON (errors/tokens/symbols/parseTree/compilationStatus/summary + warnings).

## 2) النحو العربي (ملخص)
- البرنامج: `PROGRAM ID SEMICOLON block DOT`
- قسم التعاريف: ثوابت/أنواع/متغيرات/إجراءات.
- قائمة التعليمات داخل `{ ... }` بفواصل عربية `؛`.
- العوامل: جمع/طرح/ضرب/قسمة، تعابير منطقية، مقارنة، إلخ.
- الأنواع: `صحيح/حقيقي/منطقي/حرفي/خيط_رمزي`.
- مفاتيح لغوية عربية: `برنامج، متغير، نوع، ثابت، اطبع، اقرا، اذا، والا، فان، ...`.

## 3) الفحص الدلالي
- تسجيل المتغيرات المُعرّفة في `definitions_part` عبر `visitVariable_def`.
- التحقق من تعريف مكرر.
- التحقق من الإسناد لمتغير غير معرّف.
- استنتاج نوع مبسط للتعابير (حاليًا `int` للأعداد الصحيحة، والاعتماد على الرموز للـ ID).

## 4) المُخرجات
- JSON منسّق يضم:
  - `errors`: قائمة رسائل الأخطاء.
  - `tokens`: مع نوع/لكسيم/سطر/عمود/نطاق.
  - `symbols`: الاسم/النوع/سطر التعريف.
  - `parseTree`: تمثيل نصي للشجرة.
  - `compilationStatus`: Succeeded/Failed.
  - `summary`: عدد الأخطاء/التحذيرات/التوكنز/الرموز.
  - `warnings`: تحذيرات اختيارية.

## 5) البناء والاختبار
- البناء:
```bash
cmake -S . -B build -DCMAKE_BUILD_TYPE=Release
cmake --build build -j
```
- الاختبار:
```bash
ctest --test-dir build --output-on-failure
```

## 6) التشغيل (أمثلة عربية)
```bash
echo -e "برنامج س؛ متغير س: صحيح؛ { س = 7؛ }." | ./build/my_compiler
```

## 7) التغليف
- لينكس:
  - `./scripts/package_linux.sh` يُنتج TGZ، ويحاول إنشاء DEB/RPM إذا توفّرت الأدوات.
- ويندوز:
  - Zip: `ide/windows_package.ps1`
  - MSI (يتطلب WiX): `ide/windows_msi.ps1` ثم `cpack -G WIX` داخل `build`.

## 8) IDE ويندوز (ArabicIDE)
- مشروع C# WinForms مع RTL.
- واجهة تعرض التوكنز، الرموز، الشجرة، الأخطاء، والـ JSON.
- أمر التشغيل يمرر الكود العربي إلى التنفيذية ويعرض تقرير JSON.
- تلوين نحوي بسيط للكلمات المفتاحية العربية في `RichTextBox`.

## 9) تجديد التوليد (ANTLR)
- تحديث `grammer/Expr.g4` ثم:
```bash
java -Xmx500M -cp grammer/antlr-4.13.2-complete.jar org.antlr.v4.Tool \
  -Dlanguage=Cpp -listener -visitor -package antlr_generated \
  -o src/generated grammer/Expr.g4
```

## 10) ملاحظات
- تأكد من استخدام ترميزات UTF-8 في الملفات والمحرر.
- في أمثلة النحو العربية، استخدم `؛` للفواصل و `{}` لكتلة التعليمات.
- يمكن تطوير التلوين النحوي وإضافة فحوص دلالية لأنواع أخرى.
